/* ReWebSocket.js | https://rewebsocket.html5.web.id | https://github.com/fitraditya/ReWebSocket | MIT License */
"use strict";!function(o,e){"function"==typeof define&&define.amd?define([],e):"undefined"!=typeof module&&module.exports?module.exports=e():o.ReWebSocket=e()}(this,function(){if("WebSocket"in window)return o.prototype.onopen=function(o){},o.prototype.onclose=function(o){},o.prototype.onconnecting=function(o){},o.prototype.onmessage=function(o){},o.prototype.onerror=function(o){},o.prototype.onreopen=function(o){},o.prototype.onstop=function(o){},o;function o(o,e,n){var t={debug:!1,reconnect:!0,interval:5e3,maxAttempts:0,useOfflinejs:!1};for(var i in void 0===n&&(n={}),t)n.hasOwnProperty(i)||(n[i]=t[i]);null!==e&&"string"==typeof e&&(e=[e]);var r=this;r.url=o,r.protocol=e,r.options=n,r.readyState=0,r.binaryType="blob",r.attempt=0,r.closed=!1;var c=r.timeoutInterval=null;function s(){r.readyState=c?c.readyState:0}function p(){r.attempt=0,r.closed=!1,r.onstop(null)}r.open=function(o){if(!c){if(0<r.options.maxAttempts&&o>=r.options.maxAttempts)return console.error("Maximum reconnect attempts reached."),void p();r.options.debug&&console.warn("Reconnecting, attempt "+o),r.onreopen(null),r.attempt++,(c=r.protocol?new WebSocket(r.url,r.protocol):new WebSocket(r.url)).binaryType=r.binaryType,c.onopen=function(o){s(),r.attempt=0,r.onopen(o)},c.onmessage=function(o){s(),r.onmessage(o)},c.onclose=function(o){s(),c=null,r.options.reconnect||(r.closed=!0),r.onclose(o),r.closed?p():(r.options.debug&&console.warn("WebSocket connection closed. Reconnecting."),setTimeout(function(){r.open(r.attempt)},r.options.interval))},c.onerror=function(o){s(),r.onerror(o)}}},r.open(r.attempt),r.options.useOfflinejs&&("Offline"in window?(r.Offline=Offline,Offline.on("down",function(){!c||c.readyState===WebSocket.CLOSING&&c.readyState===WebSocket.CLOSED||c.close()})):console.error("Your have to manually include offline.js in your application.")),r.send=function(o){c?(c.binaryType=r.binaryType,c.send(o)):console.error("Invalid WebSocket state while sending data.")},r.close=function(){c?(r.closed=!0,c.close()):console.error("Invalid WebSocket state while closing connection.")}}console.error("Your browser doesn't support WebSocket.")});